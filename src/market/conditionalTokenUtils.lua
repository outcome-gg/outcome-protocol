-- To extract logic to be used in the amm process

